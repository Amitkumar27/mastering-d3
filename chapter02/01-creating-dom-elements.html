<!DOCTYPE html>
<html>

    <head>
        <title>Creating Elements with D3</title>
        <link rel="stylesheet" href="../css/bootstrap.min.css">
        <link rel="stylesheet" href="../css/mastering-d3.css">
        <script src="../js/lib/d3.v3.min.js" charset="utf-8"></script>

        <style>
            /* Create a style to distinguish the data-item div elements. */
            .data-item {
                border: solid 1px black;
                margin: 4px;
                padding: 4px;
                background-color: #eeeeec;
            }
        </style>

    </head>

    <body>
        <div class="container">

            <h1>Creating DOM elements with D3</h1>

            <h4>Table of Contents</h4>

            <ul class="list-unstyled">
                <li><a href="#method-chaining">Method Chaining</a></li>
                <li><a href="#selection-call">Using selection.call</a></li>
                <li><a href="#call-function">Defining the call Argument Function</a></li>
                <li><a href="#svg">Creating a SVG Element</a></li>
            </ul>


            <!-- Section: Method Chaining -->

            <h2><a href="#method-chaining">#</a> Method Chaining</h2>
            <div class="chart-example" id="chart-01"></div>

            <script>
                // Create a simple array with three elements.
                var data = ['a', 'b', 'c'];

                // Select the container div element, create a selection for the inner
                // divs. Bind the data and append the items on enter. Append a paragraph
                // to each div and set the text attribute.
                d3.select('#chart-01').selectAll('div.data-item')
                    .data(data)
                    .enter()
                    .append('div')
                    .attr('class', 'data-item')
                    .append('p')
                    .text(function(d) { return d; });
            </script>

            <h2><a href="#selection-call">#</a> Using selection.call</h2>
            <div class="chart-example" id="chart-02"></div>

            <script>
                // We can use selection.call to encapsulate the div content creation logic.
                d3.select('#chart-02').selectAll('div.data-item')
                    .data(data)
                    .enter()
                    .append('div')
                    .call(function(selection) {
                        selection.each(function(data) {
                            d3.select(this)
                                .attr('class', 'data-item')
                                .append('p')
                                .text(data);
                        });
                    });
            </script>

            <!-- Section: Defining the Call Argument Function -->

            <h2><a href="#call-function">#</a> Defining the call Argument Function</h2>
            <div class="chart-example" id="chart-03"></div>

            <script>
                // Initialization function
                function initDiv(selection) {
                    selection.each(function(data) {
                        d3.select(this)
                            .attr('class', 'data-item')
                            .append('p')
                            .text(data);
                    });
                }

                // Call the initDiv function on each div.data-item element.
                d3.select('#chart-03').selectAll('div.data-item')
                    .data(data)
                    .enter()
                    .append('div')
                    .call(initDiv);
            </script>


            <!-- Section: Creating a SVG Element -->

            <h2><a href="#svg">#</a> Creating a SVG Element</h2>
            <div class="chart-example" id="chart-04"></div>

            <script>
                // SVG Dimensions
                var width = 400,
                    height = 40;

                // Initialization function
                function chart(selection) {
                    selection.each(function(data) {

                        // Bind the data to the svg selection.
                        var div = d3.select(this).attr('class', 'data-item'),
                            svg = div.selectAll('svg').data([data]),
                            svgEnter = svg.enter();

                        // Create the svg element and the background rectangle.
                        svgEnter.append('svg')
                            .attr('width', width)
                            .attr('height', height)
                            .append('rect')
                                .attr('width', width)
                                .attr('height', height)
                                .attr('fill', 'white');
                    });
                }

                // Use the chart function to append a SVG element in each div.
                d3.select('#chart-04').selectAll('div.data-item')
                    .data(data)
                    .enter()
                    .append('div')
                    .call(chart);
            </script>

    </div>
  </body>

</html>
